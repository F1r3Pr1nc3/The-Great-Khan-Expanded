# Use in war scope. War is deleted.
# Prev = war_participant
# Vanilla Fix: don't break the loop
end_war_effect = {
	# every_war_participant = {
	every_defender = {
		limit = {
			NOT = { is_same_empire = prevprev }
			# NOT = { is_war_participant = { who = prev side = prevprev } }
		}
		prev = { remove_war_participant = prev }
		if = { # seems superflous
			limit = {
				NAND = {
					exists = prev
					prev = { is_scope_type = war }
				}
			}
			break = yes
		}
	}
	if = { # is defenders
		limit = {
			exists = this
			is_scope_type = war
			prev = { is_war_participant = { who = prev side = prevprev } }
		}
		remove_war_participant = prev
	}
}
